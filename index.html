<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åƒè²¨ç¥å™¨ Pro</title>
    <style>
        :root { --primary: #FF9500; --bg: #F2F2F7; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { background: white; width: 100%; max-width: 450px; border-radius: 24px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* è¼¸å…¥å€åŸŸ */
        .input-group { display: flex; gap: 8px; margin-bottom: 20px; }
        input { flex: 1; border: 1.5px solid #D1D1D6; border-radius: 12px; padding: 10px; font-size: 16px; outline: none; }
        .add-btn { background: var(--primary); color: white; border: none; padding: 0 15px; border-radius: 12px; font-weight: bold; }

        .tabs { display: flex; gap: 8px; overflow-x: auto; margin-bottom: 20px; padding-bottom: 5px; }
        .tab { white-space: nowrap; padding: 8px 16px; background: #E5E5EA; border-radius: 20px; font-size: 14px; cursor: pointer; }
        .tab.active { background: var(--primary); color: white; }

        .result-card { background: #FFF9F0; border: 2px dashed var(--primary); border-radius: 20px; padding: 30px 10px; text-align: center; margin-bottom: 20px; }
        #resultValue { font-size: 38px; font-weight: bold; color: #FF4500; min-height: 50px; }
        
        .action-btns { display: none; flex-direction: column; gap: 10px; margin-top: 15px; }
        .btn { border: none; border-radius: 12px; padding: 15px; font-size: 16px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; color: white; }
        .main-btn { background: #1C1C1E; width: 100%; font-size: 20px; }
        .map-btn { background: #007AFF; }
        .share-btn { background: #5856D6; } /* ç´«è‰²åˆ†äº«éˆ• */
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center; margin-top:0;">ğŸ´ åƒè²¨ç¥å™¨ Pro</h1>

    <div class="input-group">
        <input type="text" id="customInput" placeholder="æƒ³åƒä»€éº¼ï¼Ÿ(ä¾‹: é…¸èœé­š)">
        <button class="add-btn" onclick="addCustom()">æ–°å¢</button>
    </div>

    <div class="tabs" id="tabGroup">
        <div class="tab active" onclick="switchTheme('custom')">æˆ‘çš„æ¸…å–®</div>
        <div class="tab" onclick="switchTheme('classic')">ç¶“å…¸æ¨è–¦</div>
        <div class="tab" onclick="switchTheme('japanese')">æ—¥å¼æ–™ç†</div>
    </div>

    <div class="result-card">
        <div id="resultValue">ï¼Ÿ</div>
        <div class="action-btns" id="actionGroup">
            <a id="mapLink" class="btn map-btn" target="_blank">ğŸ“ æœå°‹é™„è¿‘é¤å»³</a>
            <button class="btn share-btn" onclick="shareResult()">ğŸ“¤ åˆ†äº«åˆ°å…¶ä»– App</button>
        </div>
    </div>

    <button class="main-btn btn" onclick="roll()">é–‹å§‹éš¨æ©ŸæŠ½é¸</button>
</div>

<script>
    // åˆå§‹åŒ–è‡ªå®šç¾©æ¸…å–®
    let customList = JSON.parse(localStorage.getItem('myChoices')) || ["ç«é‹", "æ‹‰éºµ"];
    
    const database = {
        custom: customList,
        classic: ["æ¼¢å ¡", "ç‚¸é›", "ç‰›æ’", "ç‰›è‚‰éºµ", "å°ç± åŒ…", "ç¾©å¤§åˆ©éºµ"],
        japanese: ["ç”Ÿé­šç‰‡", "å¤©å©¦ç¾…", "ä¸¼é£¯", "å£½å–œç‡’", "å±…é…’å±‹"]
    };

    let currentKey = 'custom';
    let finalChoice = "";

    function switchTheme(key) {
        currentKey = key;
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        document.getElementById('resultValue').innerText = 'ï¼Ÿ';
        document.getElementById('actionGroup').style.display = 'none';
    }

    function addCustom() {
        const input = document.getElementById('customInput');
        const val = input.value.trim();
        if (val) {
            database.custom.push(val);
            localStorage.setItem('myChoices', JSON.stringify(database.custom));
            input.value = "";
            switchTheme('custom');
            alert(`å·²åŠ å…¥ï¼š${val}`);
        }
    }

    function roll() {
        const list = database[currentKey];
        if (list.length === 0) return alert("æ¸…å–®æ˜¯ç©ºçš„ï¼");

        const resultDisplay = document.getElementById('resultValue');
        const actionGroup = document.getElementById('actionGroup');
        actionGroup.style.display = 'none';

        let count = 0;
        const timer = setInterval(() => {
            resultDisplay.innerText = list[Math.floor(Math.random() * list.length)];
            count++;
            if (count > 15) {
                clearInterval(timer);
                finalChoice = list[Math.floor(Math.random() * list.length)];
                resultDisplay.innerText = "âœ¨ " + finalChoice;
                
                document.getElementById('mapLink').href = `https://www.google.com/maps/search/${finalChoice}+é¤å»³`;
                actionGroup.style.display = 'flex';
            }
        }, 80);
    }

    // --- å…¨æ–¹ä½åˆ†äº«åŠŸèƒ½ ---
    async function shareResult() {
        const shareData = {
            title: 'åƒè²¨ç¥å™¨æ±ºå®šäº†ï¼',
            text: `æˆ‘æ±ºå®šä»Šå¤©åƒï¼š${finalChoice}ï¼ä½ è¦ä¸€èµ·å—ï¼Ÿ`,
            url: window.location.href
        };

        try {
            // æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦æ”¯æ´ Web Share API (æ‰‹æ©Ÿ Safari æ”¯æ´)
            if (navigator.share) {
                await navigator.share(shareData);
            } else {
                alert("ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´åŸç”Ÿåˆ†äº«ï¼Œå»ºè­°ä½¿ç”¨ iPhone Safari é–‹å•Ÿã€‚");
            }
        } catch (err) {
            console.log('Error:', err);
        }
    }
</script>
</body>
</html>
